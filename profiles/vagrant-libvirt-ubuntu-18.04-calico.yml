---
name: vagrant-libvirt-bionic-calico
description: Vagrant profile for kubernetes with a libvirt provider with calico CNI
provisioner_name: vagrant
provisioner_args:
  box: generic/ubuntu1804
  env:
    VAGRANT_DEFAULT_PROVIDER: libvirt
ansible_overrides:
  docker_debian_version: 18.03.1~ce~3-0~ubuntu
  kubernetes_common_primary_interface: eth0
  etcd_interface: eth0
  kube_ucarp_vip_interface: eth0
  kubernetes_cni_plugin: calico
  kubernetes_cni_calico_manifest_mods:
  - conditions:
    - expression: kind
      value: DaemonSet
    modifications:
    - expression: "spec.template.spec.containers[?(@.name == 'calico-node')].env[?(@.name == 'CALICO_IPV4POOL_CIDR')].value"
      value: "172.16.0.0/16"
  kubernetes_master_kubeadm_config:
    networking:
      podSubnet: "172.16.0.0/16"
#    controllerManagerExtraArgs:
#      allocate-node-cidrs: "true"
#      cluster-cidr: "172.16.0.0/16"
